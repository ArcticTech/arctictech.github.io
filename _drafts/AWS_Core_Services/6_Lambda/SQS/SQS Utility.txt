import json
import boto3

class SqsUtility:

	@classmethod
	def clean(self, event):
		return json.loads(event['Records'][0]['body'])

	@classmethod
	def write(self, message, queue_url):
		sqs = boto3.client('sqs')
		response = sqs.send_message(QueueUrl=queue_url, MessageBody=message)
		if response['ResponseMetadata']['HTTPStatusCode'] == 200:
			return {'status': 200, 'message': 'Successfully delivered message to SQS queue.',
					'data': message}
		else:
			raise Exception('Error: Failed to deliver message to SQS queue.')

def lambda_handler(event, context):
	queue_url = 'https://sqs.us-east-1.amazonaws.com/116583825520/LITE-ZapierQueue'
	print('Attempting to write the following to queue...')
	message = json.dumps(event)
	print(message)
	result = SqsUtility.write(message, queue_url)
	print(result)
	return result